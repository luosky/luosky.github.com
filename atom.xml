<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[Luosky's Playground]]></title>
  <link href="http://luosky.github.com/atom.xml" rel="self"/>
  <link href="http://luosky.github.com/"/>
  <updated>2012-07-18T08:44:29+08:00</updated>
  <id>http://luosky.github.com/</id>
  <author>
    <name><![CDATA[Luosky]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
    <entry>
      




<title type="html"><![CDATA[PassKit (PassBook api) 学习笔记]]></title>
<link href="http://luosky.github.com/2012/06/21/passkit-passbook-api-study-notes/"/>
<updated>2012-06-21T21:40:00+08:00</updated>
<id>http://luosky.github.com/2012/06/21/passkit-passbook-api-study-notes</id>

      <content type="html"><![CDATA[<h2>PassKit 学习笔记</h2>

<p>PassBook里存放的是一个个电子凭证(pass),这些pass可以是兑换券,机票,门票等,这些pass可以通过各种第三方app,网站,或者email进行安装. PassBook本身不提供这些pass,只是提供了一个查看这些pass,以及接受pass更新的平台. PassKit则是这个平台开放的API.</p>

<h3>pass的安装方式</h3>

<ol>
<li>通过网站下载 (MIME type: application/vnd-com.apple.pkpass)</li>
<li>通过email下载</li>
<li>通过提供pass的app安装</li>
</ol>


<h3>pass type identifier</h3>

<p>必须在developer.apple.com里注册自己pass type identifier</p>

<h3>pass的类型</h3>

<ul>
<li>boardingPass</li>
<li>coupon</li>
<li>eventTicket</li>
<li>storeCard  余额卡,必须指定余额值</li>
<li>generic</li>
</ul>


<h3>pass的提醒方式</h3>

<p><strong>预先指定的提醒:</strong></p>

<ul>
<li>时间 &#8211;当时间接近时可在锁屏界面提醒用户相关信息</li>
<li>地点 &#8211;当用户接近指定地点时提醒用户相关信息(指定地点最多只能指定10个)</li>
</ul>


<p>预先指定的提醒在发布到用户的PassBook后仍可以随时被修改.</p>

<p><strong>实时提醒:</strong></p>

<ul>
<li>当pass信息需要更改时,可通过推送通知用户,界面上可展示相应的修改信息. (除了pass的类型和序列号,其他字段都可以随时修改)</li>
</ul>


<h3>pass的样式</h3>

<h4>颜色:</h4>

<p><img src="http://luosky.github.com/images/blog/2012-06-21-passkit-passbook-api-xue-xi-bi-ji/color.jpg" alt="image" /></p>

<h5>样式:</h5>

<p>store card &amp; coupon:</p>

<p><img src="http://luosky.github.com/images/blog/2012-06-21-passkit-passbook-api-xue-xi-bi-ji/logo_bg_storecard.png" alt="image" /></p>

<p>event :</p>

<p><img src="http://luosky.github.com/images/blog/2012-06-21-passkit-passbook-api-xue-xi-bi-ji/logo_bg_event.png" alt="image" /></p>

<h3>pass的字段</h3>

<p><img src="http://luosky.github.com/images/blog/2012-06-21-passkit-passbook-api-xue-xi-bi-ji/fields.jpeg" alt="image" /></p>

<ul>
<li>serialNumber用来标识pass,同样的pass type identifier 下不能有两个pass的serialNumber相同</li>
<li>只有发布时指定了验证地址和验证token的pass才能在发布后进行修改(这个token只是用来验证pass本身可以接收更新,和设备是没有关系的)</li>
<li>webServiceURL token的验证地址,指向用户自己实现的rest服务器,必须实现更新pass所需的各种接口,必须是https…</li>
<li>relevantDate 提醒用户的时间. 具体显示提醒的时间范围由pass类型决定</li>
<li>locations 提醒用户的地址.范围大小由pass类型决定</li>
<li><p>显示App Store item :
<code>
"associatedStoreIdentifiers" : [ 375380948 ]
</code></p>

<h3>注意点</h3></li>
<li><p>iPad上没有Passbook</p></li>
<li>导出P12时不用选中私钥</li>
<li>签名和打包pass可用wwdc示例代码提供的签名工具</li>
<li>BARCODE不支持中文(应该跟用的编码有关)</li>
<li>日期格式: 2012-06-20T17:30+08:00</li>
<li>使用相对时间的格式  &#8220;isRelative&#8221; : true</li>
<li>coupon的primaryFields很大,中文只能放3个字</li>
<li>PKPassLibrary不是singleton,注册PKPassLibraryDidChangeNotification通知时,通知是针对某个具体的library对象的,所以需将你创建的library传过去.</li>
</ul>


<figure class='code'><div class='highlight'><table><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'>    <span class="p">[</span><span class="n">noteCenter</span> <span class="nl">addObserver:</span><span class="n">self</span>
</span><span class='line'>                   <span class="nl">selector:</span><span class="k">@selector</span><span class="p">(</span><span class="n">passLibraryDidChange</span><span class="p">)</span>
</span><span class='line'>                       <span class="nl">name:</span><span class="n">PKPassLibraryDidChangeNotification</span>
</span><span class='line'>                     <span class="nl">object:</span><span class="n">self</span><span class="p">.</span><span class="n">library</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<p>附上自己写的 <a href="http://luosky.github.com/images/blog/2012-06-21-passkit-passbook-api-xue-xi-bi-ji/passkit_project.zip">pass工程</a>  (你可能需要换成自己开发者账号签名的pass才能在pass列表中查看已安装的pass,添加pass的话则不需要)</p>
<p><a rel="bookmark" href="http://luosky.github.com/2012/06/21/passkit-passbook-api-study-notes/">&#9875; Permalink</a></p>]]></content>
    </entry>
  
</feed>
